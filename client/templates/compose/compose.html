<template name="compose">
  <div class="modal{{#if modalOpen}} active{{/if}}">

    <div class="modal-backdrop"></div>
    <div id="compose" class="modal-window">
      <form class="post-haiku">

        <div class="close">
          {{> close}}
        </div>
        <h2 class="title">Compose a Haiku</h2>

        <!-- Haiku Text Box -->
        <div class="haiku"
        data-text-color="{{haikuTextColor}}"
        data-text-align="{{haikuTextAlign}}"
        data-text-valign="{{haikuTextValign}}"
        data-image-align="{{haikuImageAlign}}"
        data-image-valign="{{haikuImageValign}}"
        data-overlay-color="{{haikuOverlayColor}}"
        data-overlay-direction="{{haikuOverlayDirection}}"
        data-include-actions="false"
        style="{{#if haikuBackgroundImage}}background-image: url({{haikuBackgroundImage}});{{/if}}">

          <!-- OUR MAIN HAIKU. What the app listens to -->
          <div id="haiku-body" class="haiku-text" contenteditable="true"></div>

          <!-- Optional underlining for syllable identification. -->
          {{#if highlightSyllables}}
            <div class="haiku-text highlight-syllables">
              {{{formattedHaikuBody}}}
            </div>
          {{/if}}

          <!-- Placeholder text. Disappears on focus or content. -->
          {{#if showPlaceholder}}
            <span class="placeholder">Write Your Haiku...</span>
          {{/if}}

          <!-- An overlay that makes text more legible. -->
          <div class="visibility-gradient"></div>
        </div>

        <!-- Background-change and Syllable Indicator -->
        <div class="under-haiku-text flex">
          <div class="background-select-container flex-item">
            <!-- Crazy formatting is to avoid whitespace added between spans -->
            <!-- TODO: Make this generated from template. -->
            <h6 class="label">Select Background:</h6>

            <!-- Dynamically generated presets are inserted into this row -->
            <div class="presets row"><!--
           --><span class="custom">
                <input type="file" class="background-select-option upload-background">
              </span>
            </div>
          </div>

          <div class="syllable-indicator-container flex-item">
            <h6 class="label">Syllable Count</h6>
            <div class="syllable-indicators">
              <div class="line-1 count{{#if syllablePerfect 0}} perfect{{/if}}">
                <div class="num">{{syllableCount 0}}</div>
                <div class="bar" style="height: {{syllableHeight 0}}"></div>
              </div>
              <div class="line-2 count{{#if syllablePerfect 1}} perfect{{/if}}">
                <div class="num">{{syllableCount 1}}</div>
                <div class="bar" style="height: {{syllableHeight 1}}"></div>
              </div>
              <div class="line-3 count{{#if syllablePerfect 2}} perfect{{/if}}">
                <div class="num">{{syllableCount 2}}</div>
                <div class="bar" style="height: {{syllableHeight 2}}"></div>
              </div>
            </div>
          </div>
        </div>


        <!-- Advanced Mode -->

        <!-- Submit -->
        <button class='submit-haiku'>Post</button>
      </form>
    </div>
  </div>
</template>
